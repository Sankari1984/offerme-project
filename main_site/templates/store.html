

<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Ù…ØªØ¬Ø± Ø§Ù„Ø¹Ø±ÙˆØ¶</title>



  <script src="https://unpkg.com/i18next@23.4.6/i18next.min.js"></script>
  <script src="https://unpkg.com/i18next-http-backend@2.2.1/i18nextHttpBackend.min.js"></script>
  <script src="/static/js/lang.js"></script>
  <script src="/static/js/store.js"></script>
  <link rel="stylesheet" href="/static/css/store.css" />
  <link rel="manifest" href="/static/manifest.json">
  <link rel="icon" href="/static/img/favicon.ico" type="image/x-icon">





<style>
  #progressBar {
    display: flex;
    flex-direction: row-reverse; /* âœ… Ø®Ù„ÙŠ Ø§Ù„Ù…Ø¤Ø´Ø± ÙŠØ¨Ø¯Ø£ Ù…Ù† Ø§Ù„ÙŠØ³Ø§Ø± */
    gap: 4px;
    padding: 10px;
    justify-content: center;
  }

  #progressBar div {
    width: 8px;
    height: 8px;
    background-color: #aaa;
    border-radius: 50%;
    opacity: 0.5;
  }

  #progressBar div.active {
    background-color: #fff;
    opacity: 1;
  }
</style>

</head>
<body>

<!-- âœ… Ø´Ø±ÙŠØ· Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø£ÙÙ‚ÙŠ Ø£Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø© -->
<div id="socialBar">
  <div class="socialIcon" onclick="openStories()">
    <img src="/static/img/drip.gif" alt="Ø§Ù„Ù‚ØµØµ" class="drip-img" />
  </div>

  <div class="socialIcon" onclick="window.open('https://www.instagram.com/lana_couture_?utm_source=ig_web_button_share_sheet&igsh=ZDNlZDc0MzIxNw==', '_blank')">
    <img src="/static/img/instagram.png" alt="Instagram" class="drip-img" />
  </div>

  <div class="socialIcon" onclick="window.open('https://www.facebook.com/profile.php?id=61552958311412', '_blank')">
    <img src="/static/img/facebook.png" alt="Facebook" class="drip-img" />
  </div>

  <div class="socialIcon" onclick="window.open('https://www.tiktok.com/@USERNAME', '_blank')">
    <img src="/static/img/tiktok.png" alt="TikTok" class="drip-img" />
  </div>

  <!-- ğŸŒ Ø²Ø± Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ -->
  <div class="socialIcon" onclick="window.open('https://yourwebsite.com', '_blank')">
    <img src="/static/img/website.png" alt="Ø§Ù„Ù…ÙˆÙ‚Ø¹" class="drip-img" />
  </div>

  <!-- ğŸ“ Ø²Ø± Ø§Ù„Ù„ÙˆÙƒÙŠØ´Ù† (Google Maps Ø£Ùˆ Ø£ÙŠ Ø±Ø§Ø¨Ø· Ø®Ø±ÙŠØ·Ø©) -->
  <div class="socialIcon" onclick="window.open('https://maps.google.com/?q=Doha,+Qatar', '_blank')">
    <img src="/static/img/location.gif" alt="Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ" class="drip-img" />
  </div>
</div>


<!-- âœ… ÙˆØ§Ø¬Ù‡Ø© Ø¹Ø±Ø¶ Ø§Ù„Ù‚ØµØµ -->
<div id="storyOverlay" style="display: none;">
  <div class="story-header" id="progressBar"></div>
  <video id="storyVideo" playsinline muted autoplay></video>

  <!-- âœ… Ø²Ø± Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ (ÙŠØªÙ… ØªÙˆÙ„ÙŠØ¯Ù‡ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠÙ‹Ø§) -->
  <button id="storyActionButton" class="animated-btn"></button>

  <!-- âœ… Ø²Ø± Ø§Ù„Ø¥ØºÙ„Ø§Ù‚ -->
  <button onclick="closeStories()" style="
    position: absolute;
    top: 15px;
    right: 15px;
    font-size: 28px;
    background: rgba(0,0,0,0.5);
    color: white;
    border: none;
    border-radius: 50%;
    width: 36px;
    height: 36px;
    line-height: 36px;
    text-align: center;
    cursor: pointer;
    z-index: 99999;
  ">Ã—</button>
</div>


<header class="modern-header" style="display: flex; align-items: center; justify-content: space-between; padding: 10px;">
  <!-- ÙŠØ³Ø§Ø±: Ø§Ù„Ø´Ø¹Ø§Ø± -->
 <img id="storeLogo" class="store-logo-small" src="" alt="ğŸ”¶" style="height: 60px; max-width: 60px; display: none;" />

  <!-- ÙˆØ³Ø·: Ø§Ø³Ù… Ø§Ù„Ù…ØªØ¬Ø± -->
  <div id="storeOwnerDisplay" style="flex: 1; text-align: center; font-weight: bold; font-size: 18px;"></div>

  <!-- ÙŠÙ…ÙŠÙ†: Ø§Ù„Ø£Ø²Ø±Ø§Ø± -->
  <div class="header-left-buttons" style="display: flex; gap: 10px;">
    <button onclick="requestNotificationPermission()" class="btn">ğŸ”” Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</button>
    <button onclick="goToAllProducts()" class="btn">ğŸ­ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</button>
  </div>
</header>

  <div id="notificationBar" data-i18n="new_product_added" style="display:none; background:#fff3cd; color:#856404; padding:10px; text-align:center; font-weight:bold; border-bottom:1px solid #ffeeba">
    ğŸ“£ Ø¥Ø´Ø¹Ø§Ø±: ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯!
  </div>


  <div class="category-tabs" id="tabsContainer"></div>
  <main class="products-grid" id="productsContainer" style="margin-top: 80px;"></main>


  <footer class="bottom-nav">
    <button onclick="goToUpload()">
      â•<span>Ø±ÙØ¹</span>
    </button>
    <!-- âœ… Ø²Ø± Ø®Ø§Øµ Ù„Ø±ÙØ¹ Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ø°Ù‡Ø¨ÙŠØŒ ÙŠØ¸Ù‡Ø± ÙÙ‚Ø· Ù„Ù„Ù…Ø´Ø±Ù -->
    <button id="goldenProductBtn" style="display: none;" onclick="window.location.href='/upload_golden.html'">
   ğŸŒŸ<span>Ø°Ù‡Ø¨ÙŠ</span>
    </button>

    <button onclick="openServiceRequestForm()">
      ğŸ“©<span>Ø®Ø¯Ù…Ø©</span>
    </button>
    <button onclick="goToManageTabs()">
      âš™ï¸<span>Ø¥Ø¯Ø§Ø±Ø©</span>
    </button>
    <button onclick="window.location.href='notifications.html'" style="position: relative;">
      ğŸ””<span>ØªØ¹Ù„ÙŠÙ‚Ø§Øª</span>
      <span id="commentCountBadge" style="position: absolute; top: -2px; right: -2px; background: red; color: white; border-radius: 50%; padding: 2px 5px; font-size: 10px; display: none;">0</span>
    </button>


<!-- âœ… ÙÙˆØªØ± Ø§Ù„Ø²Ø§Ø¦Ø± - ÙŠØ¸Ù‡Ø± ÙÙ‚Ø· Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø²Ø§Ø¦Ø± -->



  <div id="mediaModal" onclick="if(event.target.id==='mediaModal') closeMediaModal()" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.7); justify-content:center; align-items:center; z-index:9999;">
    <div id="mediaContent" style="width: 100%; text-align: center;"></div>
  </div>

  <!-- Bottom Sheet + Overlay -->
    <div id="serviceRequestModal" class="bottom-sheet">
    <div class="sheet-content">
      <div class="drag-icon"></div>
      <h3 data-i18n="marketing_service_request">Ø·Ù„Ø¨ Ø®Ø¯Ù…Ø© ØªØ³ÙˆÙŠÙ‚ÙŠØ©</h3>
      <select id="serviceType">
        <option value="">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø®Ø¯Ù…Ø©</option>
        <option value="ØªØµÙ…ÙŠÙ… Ø¨ÙˆØ³Øª">ğŸ–¼ï¸ ØªØµÙ…ÙŠÙ… Ø¨ÙˆØ³Øª</option>
        <option value="ÙƒØªØ§Ø¨Ø© Ù…Ø­ØªÙˆÙ‰">âœï¸ ÙƒØªØ§Ø¨Ø© Ù…Ø­ØªÙˆÙ‰</option>
        <option value="Ø¥Ø¯Ø§Ø±Ø© Ø­Ù…Ù„Ø©">ğŸ“£ Ø¥Ø¯Ø§Ø±Ø© Ø­Ù…Ù„Ø©</option>
        <option value="ØªØµÙˆÙŠØ± ÙÙŠØ¯ÙŠÙˆ Ø£Ùˆ ØµÙˆØ±">ğŸ¥ ØªØµÙˆÙŠØ±</option>
        <option value="ØºÙŠØ± Ø°Ù„Ùƒ">â“ ØºÙŠØ± Ø°Ù„Ùƒ</option>
      </select>
      <textarea id="serviceDescription" placeholder="Ø§ÙƒØªØ¨ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨ Ù‡Ù†Ø§..."></textarea>
      <button id="sendButton" onclick="submitServiceRequest()">
        <span id="sendText">ğŸ“¨ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</span>
        <span id="spinner" class="spinner" style="display: none;"></span>
      </button>
      <button class="cancel-btn" onclick="closeServiceRequestForm()">âŒ Ø¥ØºÙ„Ø§Ù‚</button>
    </div>
  </div>

  <div class="overlay" id="modalOverlay" onclick="closeServiceRequestForm()"></div>

  <div id="commentPopup" class="popup" style="display:none;">
    <div class="popup-content">
      <h3>ğŸ’¬ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª</h3>
      <div id="commentsList"></div>
      <textarea id="newComment" placeholder="ğŸ’¬ Ø£Ø¶Ù ØªØ¹Ù„ÙŠÙ‚Ùƒ"></textarea>
      <button onclick="submitPopupComment()">ğŸ’¬ Ø¥Ø±Ø³Ø§Ù„</button>
      <button onclick="closePopup()">âŒ Ø¥ØºÙ„Ø§Ù‚</button>
    </div>
  </div>




  <script>
    function goToAllProducts() {
      const userId = (localStorage.getItem('user_id') || '').trim().toLowerCase();
      if (userId) {
        window.location.href = `/all_products?from_user=${userId}`;
      } else {
        window.location.href = "/all_products";
      }
    }
  </script>

  <script>
    document.addEventListener('gesturestart', function (e) { e.preventDefault(); });
    document.addEventListener('gesturechange', function (e) { e.preventDefault(); });
    document.addEventListener('gestureend', function (e) { e.preventDefault(); });
  </script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const adminId = "admin";
    const currentUser = (localStorage.getItem("user_id") || "").trim();

    if (currentUser === adminId) {
      const goldenBtn = document.getElementById("goldenProductBtn");
      if (goldenBtn) {
        goldenBtn.style.display = "inline-block";
        console.log("âœ… Ø²Ø± Ø§Ù„Ø°Ù‡Ø¨ÙŠ Ø¸Ù‡Ø± Ù„Ù„Ù…Ø´Ø±Ù");
      } else {
        console.log("âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø²Ø± goldenProductBtn");
      }
    } else {
      console.log("ğŸŸ¡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„ÙŠØ³ Ø£Ø¯Ù…Ù†:", currentUser);
    }
  });
</script>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const urlParams = new URLSearchParams(window.location.search);
    const currentUser = (localStorage.getItem("user_id") || "").trim().toLowerCase();
    const visitingUser = (urlParams.get("user_id") || "").trim().toLowerCase();
    const highlightId = urlParams.get("highlight") || "";
    const isVisitor = visitingUser && visitingUser !== currentUser;

    // âœ… Ø¥Ø°Ø§ ÙƒØ§Ù† Ø²Ø§Ø¦Ø± Ø£Ùˆ Ø¬Ø§Ø¡ Ù…Ù† all_products Ø¨Ø§Ù„Ù‡Ø§ÙŠÙ„Ø§ÙŠØª
    if (highlightId || isVisitor) {
      const visitorFooter = document.getElementById("footer-visitor");
      if (visitorFooter) visitorFooter.style.display = "flex";
    }




  });

  // âœ… Ø¯ÙˆØ§Ù„ Ø£Ø²Ø±Ø§Ø± ÙÙˆØªØ± Ø§Ù„Ø²Ø§Ø¦Ø± ÙÙ‚Ø·
  function goHome() {
    window.location.href = "/";
  }

  function goToAllProducts() {
    window.location.href = "/all_products";
  }

  function goToAllStories() {
    window.location.href = "/all_stories";
  }

  function openUserRegistration() {
    window.location.href = "/user-register";
  }
</script>

<script>
 function goToUpload() {
  window.location.href = `${window.location.origin}/upload-new.html`;
}
</script>






<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

<script>
  const storyVideo = document.getElementById("storyVideo");
  const overlay = document.getElementById("storyOverlay");
  overlay.dataset.shouldOpen = "no";

 
  const videos = [];
  let currentIndex = 0;

 function loadUserVideos() {
  fetch("/products_data.json")
    .then(res => res.json())
    .then(products => {
      videos.length = 0;
      const urlParams = new URLSearchParams(window.location.search);
      const currentUser = (localStorage.getItem("user_id") || "").trim().toLowerCase();
      const visitingUser = (urlParams.get("user_id") || "").trim().toLowerCase();

      const userId = visitingUser || currentUser; // âœ… Ø§Ø®ØªØ± Ø§Ù„Ø²Ø§Ø¦Ø± Ø¥Ù† ÙˆÙØ¬Ø¯ØŒ ÙˆØ¥Ù„Ø§ Ø®Ø° Ù…Ù† localStorage

      products.forEach(p => {
        const url = p.url || "";
        const owner = (p.user_id || "").trim().toLowerCase();
        if (url.endsWith(".m3u8") && owner === userId) {
          videos.unshift(url); // ğŸŸ¡ Ø§Ù„Ø£Ø­Ø¯Ø« Ø£ÙˆÙ„Ø§Ù‹
        }
      });

      if (overlay.dataset.shouldOpen === "yes" && videos.length > 0) {
        overlay.style.display = "flex";
        showVideo(0);
      }

    })
    .catch(err => {
      console.error("âŒ ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ø§Ù„Ø²Ø¨ÙˆÙ†:", err);
    });
}

fetch("/api/tiktok-products-full")
  .then(res => res.json())
  .then(data => {
    window.products = data;
    console.log("âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ window.products:", window.products);
  });


 function showVideo(index) {
  if (index < 0 || index >= videos.length) return;
  currentIndex = index;
  updateProgressBar();

  const videoUrl = videos[index];
  storyVideo.pause();
  storyVideo.innerHTML = "";

  if (Hls.isSupported() && videoUrl.endsWith(".m3u8")) {
    const hls = new Hls();
    hls.loadSource(videoUrl);
    hls.attachMedia(storyVideo);
  } else {
    storyVideo.src = videoUrl;
  }

  storyVideo.muted = false;
  storyVideo.play().catch(err => console.warn("âš ï¸ Ù„Ù… ÙŠÙØ´ØºÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ:", err));

  const btn = document.getElementById("storyActionButton");
  btn.style.display = "none";


  // âœ… Ø§Ø¨Ø­Ø« Ø¹Ù† Ù†ÙØ³ Ø§Ù„Ù…Ù†ØªØ¬ Ù…Ù† window.products
  const product = (window.products || []).find(p => (p.url || "").includes(videoUrl));
  if (!product) return;


  // âœ… Ø¬Ù„Ø¨ Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ Ø¥Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ Ù…Ù† Ø²Ø¨ÙˆÙ†
  fetch(`/user-settings/${product.user_id}`)
  .then(res => res.ok ? res.json() : null)
  .then(settings => {
    const whatsapp = (settings?.whatsapp || "").trim();
    const affiliate = (product.affiliate || "").trim();


btn.classList.remove("show");
btn.style.display = "none"; // Ù†Ø­Ø°Ù Ø£ÙŠ Ø¹Ø±Ø¶ Ø³Ø§Ø¨Ù‚
btn.innerHTML = "";

if (affiliate) {
  btn.innerHTML = `<img src="/static/img/aliexpress.png" style="width: 36px; height: 36px;"> Ø´Ø±Ø§Ø¡ Ø§Ù„Ù…Ù†ØªØ¬`;
  btn.onclick = () => window.open(affiliate, "_blank");

  // âœ… Ø¹Ø±Ø¶ Ø§Ù„Ø²Ø± Ø¨Ø¹Ø¯ ØªØ£Ø®ÙŠØ± Ø¨Ø³ÙŠØ· Ù…Ø¹ Ø§Ù„ÙƒÙ„Ø§Ø³
  setTimeout(() => {
    btn.style.display = "flex";
    setTimeout(() => btn.classList.add("show"), 10);
  }, 50);

} else if (whatsapp) {
  btn.innerHTML = `<img src="/static/img/whatsapp.png" style="width: 36px; height: 36px;"> ØªÙˆØ§ØµÙ„ ÙˆØ§ØªØ³Ø§Ø¨`;
  btn.onclick = () => window.open("https://wa.me/" + whatsapp, "_blank");

  setTimeout(() => {
    btn.style.display = "flex";
    setTimeout(() => btn.classList.add("show"), 10);
  }, 50);
} else {
  btn.classList.remove("show");
  setTimeout(() => { btn.style.display = "none"; }, 500);
}




  })
  .catch(err => {
    console.warn("âŒ ÙØ´Ù„ Ø¬Ù„Ø¨ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø²Ø¨ÙˆÙ†:", err);
    btn.style.display = "none";
  });
}




  function updateProgressBar() {
  const bar = document.getElementById("progressBar");
  bar.innerHTML = "";
  for (let i = 0; i < videos.length; i++) {
    const step = document.createElement("div");
    if (i === currentIndex) step.classList.add("active");
    bar.appendChild(step);
  }
}

 window.openStories = function () {
  if (videos.length === 0) {
    overlay.dataset.shouldOpen = "yes"; // âœ… Ù†ÙØªØ­ Ø¨Ø¹Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
    alert("â³ Ø¬Ø§Ø±Ù ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª... Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ù„Ø­Ø¸Ø©");
    return;
  }
  overlay.style.display = "flex";
  showVideo(0);
}



  function closeStories() {
    overlay.style.display = "none";
    storyVideo.pause();
  }

overlay.addEventListener("click", (e) => {
  const half = window.innerWidth / 2;
  if (e.clientX > half) {
    // ÙƒØ¨Ø³Ø© Ø¹Ù„Ù‰ Ø§Ù„ÙŠÙ…ÙŠÙ† â†’ ÙŠØªÙ‚Ø¯Ù… (Ù„Ù„Ø£Ù‚Ø¯Ù…)
    showVideo(currentIndex + 1);
  } else {
    // ÙƒØ¨Ø³Ø© Ø¹Ù„Ù‰ Ø§Ù„ÙŠØ³Ø§Ø± â†’ ÙŠØ±Ø¬Ø¹ Ù„Ù„Ø£Ø­Ø¯Ø«
    showVideo(currentIndex - 1);
  }
});



  // âœ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª ÙÙˆØ±Ø§Ù‹
  document.addEventListener("DOMContentLoaded", loadUserVideos);
</script>







</body>
</html>
